
parquet-teacher-test-blueprint-created-source = ${parquet-source} {"path": ${s3.path}"/"${env}"/processing/alef-test-blueprint-created"}
parquet-teacher-test-blueprint-created-sink = ${parquet-source} {"path": ${s3.path}"/"${env}"/data/alef-test-blueprint-created"}
parquet-teacher-test-blueprint-published-source = ${parquet-source} {"path": ${s3.path}"/"${env}"/processing/alef-test-blueprint-published"}
parquet-teacher-test-blueprint-published-sink = ${parquet-source} {"path": ${s3.path}"/"${env}"/data/alef-test-blueprint-published"}
parquet-teacher-test-blueprint-deleted-source = ${parquet-source} {"path": ${s3.path}"/"${env}"/processing/alef-test-blueprint-discarded"}
parquet-teacher-test-blueprint-deleted-sink = ${parquet-source} {"path": ${s3.path}"/"${env}"/data/alef-test-blueprint-discarded"}
parquet-teacher-test-blueprint-archived-source = ${parquet-source} {"path": ${s3.path}"/"${env}"/processing/alef-test-blueprint-archived"}
parquet-teacher-test-blueprint-archived-sink = ${parquet-source} {"path": ${s3.path}"/"${env}"/data/alef-test-blueprint-archived"}
transformed-teacher-test-blueprint = ${parquet-source-overwrite} {"path": ${s3.path}"/"${env}"/transformed/alef-test-blueprint"}
transformed_teacher_test_blueprint_lesson_association = ${parquet-source-overwrite} {"path": ${s3.path}"/"${env}"/transformed/alef-test-blueprint-lesson-association"}

delta-teacher-test-blueprint-sink = ${delta-sink} {"path" = ${s3.delta.path}"/"${env}"/alef-teacher-test-blueprint"}
redshift-teacher-test-blueprint-sink = ${redshift} {"dbtable": ${redshift-schema}".dim_teacher_test_blueprint"}

delta-teacher-test-blueprint-lesson-association-sink = ${delta-sink} {"path" = ${s3.delta.path}"/"${env}"/alef-teacher-test-blueprint-lesson-association"}
redshift-teacher-test-blueprint-lesson-association-sink = ${redshift} {"dbtable": ${redshift-schema}".dim_teacher_test_blueprint_lesson_association"}

parquet-teacher-test-blueprint-created {
    source: [
          "parquet-teacher-test-blueprint-created-source"
        ]
        sink: [
          "parquet-teacher-test-blueprint-created-sink"
        ]
}

parquet-teacher-test-blueprint-published {
    source: [
           "parquet-teacher-test-blueprint-published-source"
        ]
        sink: [
           "parquet-teacher-test-blueprint-published-sink"
        ]
}

parquet-teacher-test-blueprint-discarded {
    source: [
           "parquet-teacher-test-blueprint-deleted-source"
        ]
        sink: [
           "parquet-teacher-test-blueprint-deleted-sink"
        ]
}

parquet-teacher-test-blueprint-archived {
    source: [
            "parquet-teacher-test-blueprint-archived-source"
        ]
    sink: [
            "parquet-teacher-test-blueprint-archived-sink"
        ]
}

delta-teacher-test-blueprint-lesson-service {
    source: "transformed_teacher_test_blueprint_lesson_association"
    sink: ["delta-teacher-test-blueprint-lesson-association-sink"]
    unique-ids: ["ttbla_test_blueprint_id"]
    entity-prefix: "ttbla"
}

redshift-teacher-test-blueprint-lesson-service {
            source: "transformed_teacher_test_blueprint_lesson_association"
            sink: ["redshift-teacher-test-blueprint-lesson-association-sink"]
            dim-table: "dim_teacher_test_blueprint_lesson_association"
            unique-ids: ["ttbla_test_blueprint_id"]
            entity-prefix: "ttbla"
            inactive_status_value: 2,
            is-staging: false
}

delta-teacher-test-blueprint-created-service {
            source: "transformed-teacher-test-blueprint",
            sink:  "delta-teacher-test-blueprint-sink"
            unique-ids: ["ttb_test_blueprint_id"]
            inactive_status_value: 2
}

redshift-teacher-test-blueprint-created-service {
    source: "transformed-teacher-test-blueprint"
    sink: "redshift-teacher-test-blueprint-sink"
    table-name: "dim_teacher_test_blueprint"
    exclude-columns: [
                ]
    unique-ids: ["ttb_test_blueprint_id"],
    inactive_status_value: 2,
    is-staging: false
}



teacher-test-blueprint-mutated-transform {
       create: {
                 source: ["parquet-teacher-test-blueprint-created-source"]
                 column-mapping: {
                                 id: "ttb_test_blueprint_id",
                                 tenantId: "ttb_tenant_id",
                                 contextFrameClassId: "ttb_test_blueprint_class_id",
                                 contextFrameTitle: "ttb_test_blueprint_title",
                                 contextDomainId: "ttb_test_blueprint_domain_id",
                                 guidanceType: "ttb_test_blueprint_guidance_type",
                                 guidanceVersion.major: "ttb_test_blueprint_major_version",
                                 guidanceVersion.minor: "ttb_test_blueprint_minor_version",
                                 guidanceVersion.revision: "ttb_test_blueprint_revision_version",
                                 createdBy: "ttb_test_blueprint_created_by_id",
                                 status: "ttb_test_blueprint_status",
                                 occurredOn: "occurredOn",
                                 ttb_status: "ttb_status"
                               }
              }
              update: {
                 source: ["parquet-teacher-test-blueprint-published-source"]
                 column-mapping: {
                                  id: "ttb_test_blueprint_id",
                                  tenantId: "ttb_tenant_id",
                                  contextFrameClassId: "ttb_test_blueprint_class_id",
                                  contextFrameTitle: "ttb_test_blueprint_title",
                                  contextDomainId: "ttb_test_blueprint_domain_id",
                                  guidanceType: "ttb_test_blueprint_guidance_type",
                                  guidanceVersion.major: "ttb_test_blueprint_major_version",
                                  guidanceVersion.minor: "ttb_test_blueprint_minor_version",
                                  guidanceVersion.revision: "ttb_test_blueprint_revision_version",
                                  noOfQuestions: "ttb_test_blueprint_number_of_question",
                                  createdBy: "ttb_test_blueprint_created_by_id",
                                  updatedBy: "ttb_test_blueprint_updated_by_id",
                                  publishedBy: "ttb_test_blueprint_published_by_id",
                                  status: "ttb_test_blueprint_status",
                                  occurredOn: "occurredOn",
                                  ttb_status: "ttb_status"
                 }
              }
              delete: {
                        source: ["parquet-teacher-test-blueprint-deleted-source", "parquet-teacher-test-blueprint-archived-source"]
                        column-mapping: {
                                             "id": "ttb_test_blueprint_id",
                                             "status": "ttb_test_blueprint_status",
                                             "updatedBy": "ttb_test_blueprint_updated_by_id",
                                             "occurredOn": "occurredOn"
                        }
              }
              table-name: "delta-teacher-test-blueprint-sink"
              sink: "transformed-teacher-test-blueprint"
              entity: "ttb",
              unique-ids: ["id"],
              key: "dim_teacher_test_blueprint"
}

teacher-test-blueprint-lesson-transform {
           source: ["parquet-teacher-test-blueprint-published-source"]
           sink: "transformed_teacher_test_blueprint_lesson_association"
           delete-event-name: ""
           column-mapping: {
                         id: "ttbla_test_blueprint_id",
                         guidanceVariableLessons.id: "ttbla_lesson_id",
                         ttbla_status: "ttbla_status",
                         occurredOn: "occurredOn",
                         ttbla_active_until: "ttbla_active_until",
           }
           transformations: [
                             {
                               "operation": "explode"
                               "columns": ["guidanceVariableLessons"]
                             }
                           ]
           config-after-scd-transformations: [
                                        {
                                          "operation": "dropDuplicates"
                                          "columns": []
                                        }
           ]
           entity: "ttbla",
           unique-ids: ["id"],
           key: "dim_teacher_test_blueprint_lesson_association"
}
