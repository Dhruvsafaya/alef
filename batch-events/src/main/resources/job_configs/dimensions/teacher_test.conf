
parquet-teacher-test-created-source = ${parquet-source} {"path": ${s3.path}"/"${env}"/processing/alef-test-created"}
parquet-teacher-test-created-sink = ${parquet-source} {"path": ${s3.path}"/"${env}"/data/alef-test-created"}
parquet-teacher-test-published-source = ${parquet-source} {"path": ${s3.path}"/"${env}"/processing/alef-test-published"}
parquet-teacher-test-published-sink = ${parquet-source} {"path": ${s3.path}"/"${env}"/data/alef-test-published"}
transformed-teacher-test = ${parquet-source-overwrite} {"path": ${s3.path}"/"${env}"/transformed/alef-test-published"}
parquet-teacher-test-deleted-source = ${parquet-source} {"path": ${s3.path}"/"${env}"/processing/alef-test-discarded"}
parquet-teacher-test-deleted-sink = ${parquet-source} {"path": ${s3.path}"/"${env}"/data//alef-test-discarded"}
parquet-teacher-test-archived-source = ${parquet-source} {"path": ${s3.path}"/"${env}"/processing/alef-test-archived"}
parquet-teacher-test-archived-sink = ${parquet-source} {"path": ${s3.path}"/"${env}"/data/alef-test-archived"}
transformed_teacher_test_item_association = ${parquet-source-overwrite} {"path": ${s3.path}"/"${env}"/transformed/alef-test-item-association"}

delta-teacher-test-sink = ${delta-sink} {"path" = ${s3.delta.path}"/"${env}"/alef-teacher-test"}
redshift-teacher-test-sink = ${redshift} {"dbtable": ${redshift-schema}".dim_teacher_test"}

delta-teacher-test-item-association-sink = ${delta-sink} {"path" = ${s3.delta.path}"/"${env}"/alef-teacher-test-item-association"}
redshift-teacher-test-item-association-sink = ${redshift} {"dbtable": ${redshift-schema}".dim_teacher_test_item_association"}

parquet-teacher-test-created {
    source: [
          "parquet-teacher-test-created-source"
        ]
        sink: [
          "parquet-teacher-test-created-sink"
        ]
}

parquet-teacher-test-published {
    source: [
           "parquet-teacher-test-published-source"
        ]
        sink: [
           "parquet-teacher-test-published-sink"
        ]
}

parquet-teacher-test-deleted {
    source: [
           "parquet-teacher-test-deleted-source"
        ]
        sink: [
           "parquet-teacher-test-deleted-sink"
        ]
}

parquet-teacher-test-archived {
    source: [
          "parquet-teacher-test-archived-source"
    ]
    sink: [
          "parquet-teacher-test-archived-sink"
    ]
}

teacher-test-mutated-transform {
       create: {
                 source: ["parquet-teacher-test-created-source"]
                 column-mapping: {
                                 testId: "tt_test_id",
                                 testBlueprintId: "tt_test_blueprint_id",
                                 tenantId: "tt_tenant_id",
                                 contextFrameClassId: "tt_test_class_id",
                                 contextFrameTitle: "tt_test_title",
                                 contextFrameDescription: "tt_test_description",
                                 contextDomainId: "tt_test_domain_id",
                                 status: "tt_test_status",
                                 createdBy: "tt_test_created_by_id",
                                 occurredOn: "occurredOn",
                                 tt_status: "tt_status"
                               }
              }
              update: {
                 source: ["parquet-teacher-test-published-source"]
                 column-mapping: {
                               testId: "tt_test_id",
                               testBlueprintId: "tt_test_blueprint_id",
                               tenantId: "tt_tenant_id",
                               contextFrameClassId: "tt_test_class_id",
                               contextFrameTitle: "tt_test_title",
                               contextFrameDescription: "tt_test_description",
                               contextDomainId: "tt_test_domain_id",
                               status: "tt_test_status",
                               updatedBy: "tt_test_updated_by_id",
                               publishedBy: "tt_test_published_by_id",
                               occurredOn: "occurredOn",
                               tt_status: "tt_status"
                 }
              }
               delete: {
                                      source: ["parquet-teacher-test-deleted-source", "parquet-teacher-test-archived-source"]
                                      column-mapping: {
                                                           "testId": "tt_test_id",
                                                           "status": "tt_test_status",
                                                           "updatedBy": "tt_test_updated_by_id",
                                                           "occurredOn": "occurredOn"
                                      }
                            }
              sink: "transformed-teacher-test"
              entity: "tt",
              unique-ids: ["testId"],
              key: "dim_teacher_test"
              table-name: "delta-teacher-test-sink"
}

teacher-test-item-transform {
           source: ["parquet-teacher-test-published-source"]
           sink: "transformed_teacher_test_item_association"
           delete-event-name: ""
           column-mapping: {
                         testId: "ttia_test_id",
                         items.id: "ttia_test_item_id",
                         ttia_status: "ttia_status",
                         occurredOn: "occurredOn",
                         ttia_active_until: "ttia_active_until",
           }
           transformations: [
                             {
                               "operation": "explode"
                               "columns": ["items"]
                             }
                           ]
           entity: "ttia",
           unique-ids: ["testId"],
           key: "dim_teacher_test_item_association"
}

delta-teacher-test-item-service {
    source: "transformed_teacher_test_item_association"
    sink: ["delta-teacher-test-item-association-sink"]
    unique-ids: ["ttia_test_id"]
    entity-prefix: "ttia"
}

redshift-teacher-test-item-service {
            source: "transformed_teacher_test_item_association"
            sink: ["redshift-teacher-test-item-association-sink"]
            dim-table: "dim_teacher_test_item_association"
            unique-ids: ["ttia_test_id"]
            entity-prefix: "ttia"
            inactive_status_value: 2,
            is-staging: false
}

delta-teacher-test-created-service {
            source: "transformed-teacher-test",
            sink:  "delta-teacher-test-sink"
            unique-ids: ["tt_test_id"]
            inactive_status_value: 2
}

redshift-teacher-test-created-service {
    source: "transformed-teacher-test"
    sink: "redshift-teacher-test-sink"
    table-name: "dim_teacher_test"
    exclude-columns: ["tt_test_description"]
    unique-ids: ["tt_test_id"],
    inactive_status_value: 2,
    is-staging: false
}
